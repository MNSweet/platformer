<!doctype html>
<html>
<head>
		<title>My fancy game</title>
</head>
<body style="padding:10px 0 0; background-color:#000;">

<canvas id="canvas" style="border:1px solid #000; display:block; margin:auto; background-color:#77BBFF;"></canvas>
<script type="text/javascript">var debug = true;</script>
<script type="text/javascript" src="js/assets.lib.js"></script>
<script type="text/javascript" src="js/display.js"></script>
<script type="text/javascript" src="js/entities.js"></script>
<script type="text/javascript" src="js/structure.js"></script>
<script>
(function() {
	var requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame;
	window.requestAnimationFrame = requestAnimationFrame;
})();
var canvas = document.getElementById("canvas"),
	ctx = canvas.getContext("2d"),
	width = 1000,
	height = 400,
	player = {},
	keys = [],
	gravity = 0.3,
	friction = 0.8,
	structures = [];

var background = Background('feild','img/map.jpg',800,500);


canvas.width = width;
canvas.height = height;

document.body.addEventListener("keydown", function(e) {
	keys[e.keyCode] = true;
});
 
document.body.addEventListener("keyup", function(e) {
	keys[e.keyCode] = false;
});

function update(){
	//reset screen
	ctx.clearRect(0,0,width,height);
	bg.draw('main');
	//background.drawPattern();

	player.grounded = false;

	//render obstacles
	for (var i = 0; i < structures.length; i++) {
		player.testCollision.structure(structures[i]);
		structures[i].update();
	};

	player.update();

	// run through the loop again
	requestAnimationFrame(update);
};


window.addEventListener("load", function(){
	player = Player();
	structures.push(Ground(0,height-10,width*2,15));
	structures.push(Tower(0,0,100,height-10,10));
	update();
});
	
</script>
</body>
</html>